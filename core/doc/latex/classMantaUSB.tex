\hypertarget{classMantaUSB}{\section{\-Manta\-U\-S\-B \-Class \-Reference}
\label{classMantaUSB}\index{\-Manta\-U\-S\-B@{\-Manta\-U\-S\-B}}
}


\-Superclass that handles the low-\/level \-U\-S\-B communication with the \hyperlink{classManta}{\-Manta}.  




{\ttfamily \#include $<$\-Manta\-U\-S\-B.\-h$>$}



\-Inheritance diagram for \-Manta\-U\-S\-B\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=144pt]{classMantaUSB__inherit__graph}
\end{center}
\end{figure}


\-Collaboration diagram for \-Manta\-U\-S\-B\-:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classMantaUSB__coll__graph}
\end{center}
\end{figure}
\subsection*{\-Classes}
\begin{DoxyCompactItemize}
\item 
struct \hyperlink{structMantaUSB_1_1MantaTxQueueEntry}{\-Manta\-Tx\-Queue\-Entry}
\end{DoxyCompactItemize}
\subsection*{\-Public \-Member \-Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classMantaUSB_a3a7fbf215f3c81e434985783f32f3afc}{\-Manta\-U\-S\-B} (void)
\item 
virtual \hyperlink{classMantaUSB_a9d1ab2b1586314afc1473e99a78c0d06}{$\sim$\-Manta\-U\-S\-B} (void)
\item 
void \hyperlink{classMantaUSB_a38a9bc76333bab47574c63e1fe610002}{\-Write\-Frame} (uint8\-\_\-t $\ast$frame, bool force\-Queued)
\begin{DoxyCompactList}\small\item\em \-Writs a \-U\-S\-B transfer frame down to the \hyperlink{classManta}{\-Manta}. \end{DoxyCompactList}\item 
bool \hyperlink{classMantaUSB_a8464350b672b1c10f537bb2e3147e1c3}{\-Is\-Connected} (void)
\item 
void \hyperlink{classMantaUSB_a51e68daa5edfbc7ced89b6f9faa86ed5}{\-Connect} (int connection\-Serial=0)
\item 
void \hyperlink{classMantaUSB_abf5cac050689cc24982510e8f5adb71c}{\-Disconnect} ()
\item 
int \hyperlink{classMantaUSB_a5be6f8f54e60727c5c9b624125194d45}{\-Get\-Serial\-Number} (void)
\item 
bool \hyperlink{classMantaUSB_a3806f690096fa9a8885cd2d4733a898d}{\-Message\-Queued} (void)
\end{DoxyCompactItemize}
\subsection*{\-Static \-Public \-Member \-Functions}
\begin{DoxyCompactItemize}
\item 
static void \hyperlink{classMantaUSB_a4d55c1c1d9e769ce7a0ef532a72221e8}{\-Handle\-Events} (void)
\begin{DoxyCompactList}\small\item\em \-Services \-U\-S\-B communciation with the \hyperlink{classManta}{\-Manta}. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{\-Protected \-Member \-Functions}
\begin{DoxyCompactItemize}
\item 
virtual void \hyperlink{classMantaUSB_abcf3545bb86f2175148bd06574b81632}{\-Frame\-Received} (int8\-\_\-t $\ast$frame)=0
\item 
virtual void \hyperlink{classMantaUSB_a0b77693f738aa98742dc259e09feb5dd}{\-Debug\-Print} (const char $\ast$fmt,...)
\end{DoxyCompactItemize}
\subsection*{\-Protected \-Attributes}
\begin{DoxyCompactItemize}
\item 
int \hyperlink{classMantaUSB_a665d9f2432ded4c447e53dba384cbb69}{\-Serial\-Number}
\item 
int \hyperlink{classMantaUSB_a689a16560bfa8ecd1681e2f0397f68f2}{\-Manta\-Index}
\end{DoxyCompactItemize}
\subsection*{\-Static \-Protected \-Attributes}
\begin{DoxyCompactItemize}
\item 
static const int \hyperlink{classMantaUSB_a32fd2c8f871a3639bf913f599c2f3b04}{\-Out\-Packet\-Len} = 16
\item 
static const int \hyperlink{classMantaUSB_a13d2528c9c12d91dd34a8f99b3fed0b3}{\-In\-Packet\-Len} = 64
\end{DoxyCompactItemize}
\subsection*{\-Private \-Member \-Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{structMantaUSB_1_1MantaTxQueueEntry}{\-Manta\-Tx\-Queue\-Entry} $\ast$ \hyperlink{classMantaUSB_a2413f83812c4dd4b08af054e2e5506d3}{\-Get\-Queued\-Tx\-Message} ()
\end{DoxyCompactItemize}
\subsection*{\-Private \-Attributes}
\begin{DoxyCompactItemize}
\item 
\hyperlink{MantaUSB_8h_aa6da74d5686d198dd3e5440e60088fcc}{hid\-\_\-device} $\ast$ \hyperlink{classMantaUSB_ab1b01bd783ce58a4cfceadaf593759e8}{\-Device\-Handle}
\end{DoxyCompactItemize}
\subsection*{\-Static \-Private \-Attributes}
\begin{DoxyCompactItemize}
\item 
static const int \hyperlink{classMantaUSB_acde414c7e155d869f5c399518e32d38d}{\-Interface} = 0
\item 
static const int \hyperlink{classMantaUSB_afe5ae885264a5aff980c5c645a3ff9d6}{\-Endpoint\-In} = 0x81
\item 
static const int \hyperlink{classMantaUSB_ab3926f81d0c1b5993d583a34343e0b6d}{\-Endpoint\-Out} = 0x02
\item 
static const int \hyperlink{classMantaUSB_aa2a88b5675ef513922f1bd4748d12181}{\-Timeout} = 5000
\item 
static const int \hyperlink{classMantaUSB_ad3b9f90c7681710d99dd984000a7859e}{\-Vendor\-I\-D} = 0x2424
\item 
static const int \hyperlink{classMantaUSB_aa78f9ab72991bc6ed711e6b823e98a00}{\-Product\-I\-D} = 0x2424
\item 
static list$<$ \hyperlink{classMantaUSB}{\-Manta\-U\-S\-B} $\ast$ $>$ \hyperlink{classMantaUSB_a6c2c001a6d17abfd0f6ab6a6d36ce288}{manta\-List}
\item 
static list$<$ \hyperlink{structMantaUSB_1_1MantaTxQueueEntry}{\-Manta\-Tx\-Queue\-Entry} $\ast$ $>$ \hyperlink{classMantaUSB_ab647636b02371d10ccedaf719b6b7de2}{tx\-Queue}
\end{DoxyCompactItemize}


\subsection{\-Detailed \-Description}
\-Superclass that handles the low-\/level \-U\-S\-B communication with the \hyperlink{classManta}{\-Manta}. 

\-The \hyperlink{classMantaUSB}{\-Manta\-U\-S\-B} class handles the low-\/level \-U\-S\-B communication with the \hyperlink{classManta}{\-Manta} over hid\-A\-P\-I, a cross-\/platform \-H\-I\-D library.

\-The public methods of this class are meant to be used by applciations using libmanta to manage the connection to a physical \hyperlink{classManta}{\-Manta}, as well as servicing the low-\/level \-U\-S\-B drivers by periodically calling the \hyperlink{classMantaUSB_a4d55c1c1d9e769ce7a0ef532a72221e8}{\-Handle\-Events()} function. 

\-Definition at line 28 of file \-Manta\-U\-S\-B.\-h.



\subsection{\-Constructor \& \-Destructor \-Documentation}
\hypertarget{classMantaUSB_a3a7fbf215f3c81e434985783f32f3afc}{\index{\-Manta\-U\-S\-B@{\-Manta\-U\-S\-B}!\-Manta\-U\-S\-B@{\-Manta\-U\-S\-B}}
\index{\-Manta\-U\-S\-B@{\-Manta\-U\-S\-B}!MantaUSB@{\-Manta\-U\-S\-B}}
\subsubsection[{\-Manta\-U\-S\-B}]{\setlength{\rightskip}{0pt plus 5cm}{\bf \-Manta\-U\-S\-B\-::\-Manta\-U\-S\-B} (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}}\label{classMantaUSB_a3a7fbf215f3c81e434985783f32f3afc}


\-Definition at line 9 of file \-Manta\-U\-S\-B.\-cpp.


\begin{DoxyCode}
                       :
   SerialNumber(0),
   DeviceHandle(NULL)
{
   mantaList.push_back(this);
   MantaIndex = mantaList.size();

   DebugPrint("%s-%d: Manta %d initialized", __FILE__, __LINE__, MantaIndex);
}
\end{DoxyCode}
\hypertarget{classMantaUSB_a9d1ab2b1586314afc1473e99a78c0d06}{\index{\-Manta\-U\-S\-B@{\-Manta\-U\-S\-B}!$\sim$\-Manta\-U\-S\-B@{$\sim$\-Manta\-U\-S\-B}}
\index{$\sim$\-Manta\-U\-S\-B@{$\sim$\-Manta\-U\-S\-B}!MantaUSB@{\-Manta\-U\-S\-B}}
\subsubsection[{$\sim$\-Manta\-U\-S\-B}]{\setlength{\rightskip}{0pt plus 5cm}{\bf \-Manta\-U\-S\-B\-::$\sim$\-Manta\-U\-S\-B} (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily  \mbox{[}virtual\mbox{]}}}}\label{classMantaUSB_a9d1ab2b1586314afc1473e99a78c0d06}


\-Definition at line 19 of file \-Manta\-U\-S\-B.\-cpp.


\begin{DoxyCode}
{
   Disconnect();
   mantaList.remove(this);
   if(mantaList.empty())
   {
      hid_exit();
   }
}
\end{DoxyCode}


\subsection{\-Member \-Function \-Documentation}
\hypertarget{classMantaUSB_a51e68daa5edfbc7ced89b6f9faa86ed5}{\index{\-Manta\-U\-S\-B@{\-Manta\-U\-S\-B}!\-Connect@{\-Connect}}
\index{\-Connect@{\-Connect}!MantaUSB@{\-Manta\-U\-S\-B}}
\subsubsection[{\-Connect}]{\setlength{\rightskip}{0pt plus 5cm}void {\bf \-Manta\-U\-S\-B\-::\-Connect} (
\begin{DoxyParamCaption}
\item[{int}]{connection\-Serial = {\ttfamily 0}}
\end{DoxyParamCaption}
)}}\label{classMantaUSB_a51e68daa5edfbc7ced89b6f9faa86ed5}


\-Definition at line 92 of file \-Manta\-U\-S\-B.\-cpp.


\begin{DoxyCode}
{
#define SERIAL_STRING_SIZE 32
   wchar_t serialString[SERIAL_STRING_SIZE];

   if(IsConnected())
   {
      return;
   }

   DebugPrint("%s-%d: Attempting to Connect to Manta %d...",
         __FILE__, __LINE__, connectionSerial);
   if(connectionSerial)
   {
      swprintf(serialString, SERIAL_STRING_SIZE, L"%d", connectionSerial);
      DeviceHandle = hid_open(VendorID, ProductID, serialString);
   }
   else
   {
      DeviceHandle = hid_open(VendorID, ProductID, NULL);
   }
   if(NULL == DeviceHandle)
      throw(MantaNotFoundException());
   hid_get_serial_number_string(DeviceHandle, serialString, SERIAL_STRING_SIZE)
      ;
   SerialNumber = wcstol(serialString, NULL, 10);
   hid_set_nonblocking(DeviceHandle, 1);
}
\end{DoxyCode}
\hypertarget{classMantaUSB_a0b77693f738aa98742dc259e09feb5dd}{\index{\-Manta\-U\-S\-B@{\-Manta\-U\-S\-B}!\-Debug\-Print@{\-Debug\-Print}}
\index{\-Debug\-Print@{\-Debug\-Print}!MantaUSB@{\-Manta\-U\-S\-B}}
\subsubsection[{\-Debug\-Print}]{\setlength{\rightskip}{0pt plus 5cm}virtual void {\bf \-Manta\-U\-S\-B\-::\-Debug\-Print} (
\begin{DoxyParamCaption}
\item[{const char $\ast$}]{fmt, }
\item[{}]{...}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily  \mbox{[}inline, protected, virtual\mbox{]}}}}\label{classMantaUSB_a0b77693f738aa98742dc259e09feb5dd}


\-Definition at line 44 of file \-Manta\-U\-S\-B.\-h.


\begin{DoxyCode}
{}
\end{DoxyCode}
\hypertarget{classMantaUSB_abf5cac050689cc24982510e8f5adb71c}{\index{\-Manta\-U\-S\-B@{\-Manta\-U\-S\-B}!\-Disconnect@{\-Disconnect}}
\index{\-Disconnect@{\-Disconnect}!MantaUSB@{\-Manta\-U\-S\-B}}
\subsubsection[{\-Disconnect}]{\setlength{\rightskip}{0pt plus 5cm}void {\bf \-Manta\-U\-S\-B\-::\-Disconnect} (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}}\label{classMantaUSB_abf5cac050689cc24982510e8f5adb71c}


\-Definition at line 120 of file \-Manta\-U\-S\-B.\-cpp.


\begin{DoxyCode}
{
   if(! IsConnected())
   {
      return;
   }

   DebugPrint("%s-%d: Manta %d Disconnecting...", __FILE__, __LINE__, 
      GetSerialNumber());
   hid_close(DeviceHandle);
   DeviceHandle = NULL;
}
\end{DoxyCode}
\hypertarget{classMantaUSB_abcf3545bb86f2175148bd06574b81632}{\index{\-Manta\-U\-S\-B@{\-Manta\-U\-S\-B}!\-Frame\-Received@{\-Frame\-Received}}
\index{\-Frame\-Received@{\-Frame\-Received}!MantaUSB@{\-Manta\-U\-S\-B}}
\subsubsection[{\-Frame\-Received}]{\setlength{\rightskip}{0pt plus 5cm}virtual void {\bf \-Manta\-U\-S\-B\-::\-Frame\-Received} (
\begin{DoxyParamCaption}
\item[{int8\-\_\-t $\ast$}]{frame}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily  \mbox{[}protected, pure virtual\mbox{]}}}}\label{classMantaUSB_abcf3545bb86f2175148bd06574b81632}


\-Implemented in \hyperlink{classManta_ae2de440aa98c29ddc39c5870d6936112}{\-Manta}.

\hypertarget{classMantaUSB_a2413f83812c4dd4b08af054e2e5506d3}{\index{\-Manta\-U\-S\-B@{\-Manta\-U\-S\-B}!\-Get\-Queued\-Tx\-Message@{\-Get\-Queued\-Tx\-Message}}
\index{\-Get\-Queued\-Tx\-Message@{\-Get\-Queued\-Tx\-Message}!MantaUSB@{\-Manta\-U\-S\-B}}
\subsubsection[{\-Get\-Queued\-Tx\-Message}]{\setlength{\rightskip}{0pt plus 5cm}{\bf \-Manta\-U\-S\-B\-::\-Manta\-Tx\-Queue\-Entry} $\ast$ {\bf \-Manta\-U\-S\-B\-::\-Get\-Queued\-Tx\-Message} (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily  \mbox{[}private\mbox{]}}}}\label{classMantaUSB_a2413f83812c4dd4b08af054e2e5506d3}


\-Definition at line 208 of file \-Manta\-U\-S\-B.\-cpp.


\begin{DoxyCode}
{
   list<MantaTxQueueEntry *>::iterator i = txQueue.begin();
   /* look for the first queued message matching this manta */
   while(txQueue.end() != i)
   {
      if((*i)->TargetManta == this)
      {
         return *i;
      }
      ++i;
   }
   return NULL;
}
\end{DoxyCode}
\hypertarget{classMantaUSB_a5be6f8f54e60727c5c9b624125194d45}{\index{\-Manta\-U\-S\-B@{\-Manta\-U\-S\-B}!\-Get\-Serial\-Number@{\-Get\-Serial\-Number}}
\index{\-Get\-Serial\-Number@{\-Get\-Serial\-Number}!MantaUSB@{\-Manta\-U\-S\-B}}
\subsubsection[{\-Get\-Serial\-Number}]{\setlength{\rightskip}{0pt plus 5cm}int {\bf \-Manta\-U\-S\-B\-::\-Get\-Serial\-Number} (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}}\label{classMantaUSB_a5be6f8f54e60727c5c9b624125194d45}


\-Definition at line 202 of file \-Manta\-U\-S\-B.\-cpp.


\begin{DoxyCode}
{
   /* TODO: get serial number */
   return SerialNumber;
}
\end{DoxyCode}
\hypertarget{classMantaUSB_a4d55c1c1d9e769ce7a0ef532a72221e8}{\index{\-Manta\-U\-S\-B@{\-Manta\-U\-S\-B}!\-Handle\-Events@{\-Handle\-Events}}
\index{\-Handle\-Events@{\-Handle\-Events}!MantaUSB@{\-Manta\-U\-S\-B}}
\subsubsection[{\-Handle\-Events}]{\setlength{\rightskip}{0pt plus 5cm}void {\bf \-Manta\-U\-S\-B\-::\-Handle\-Events} (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily  \mbox{[}static\mbox{]}}}}\label{classMantaUSB_a4d55c1c1d9e769ce7a0ef532a72221e8}


\-Services \-U\-S\-B communciation with the \hyperlink{classManta}{\-Manta}. 


\begin{DoxyParams}{\-Parameters}
{\em none} & \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{\-Returns}
none
\end{DoxyReturn}
\-Handle\-Events should be called periodically to poll all connected \-Mantas for incoming \-U\-S\-B frames as well as to send any messages that have been queued up with \hyperlink{classMantaUSB_a38a9bc76333bab47574c63e1fe610002}{\-Write\-Frame()}. \-It should be called at least once every 6ms, but you may get improved results polling as fast as every 1ms if your application supports it.

\-Note\-: \-Because \hyperlink{classMantaUSB_a38a9bc76333bab47574c63e1fe610002}{\-Write\-Frame()} accesses the same message queue that \hyperlink{classMantaUSB_a4d55c1c1d9e769ce7a0ef532a72221e8}{\-Handle\-Events()} does, they should be protected from each other by a mutex on the application level if they're being called from parallel threads. 

\-Definition at line 147 of file \-Manta\-U\-S\-B.\-cpp.


\begin{DoxyCode}
{
   list<MantaUSB *>::iterator i = mantaList.begin();
   /* read from each manta and trigger any events */
   while(mantaList.end() != i)
   {
      MantaUSB *current = *i;
      if(current->IsConnected())
      {
         int bytesRead;
         int8_t inFrame[InPacketLen];

         bytesRead = hid_read(current->DeviceHandle,
               reinterpret_cast<uint8_t *>(inFrame), InPacketLen);
         if(bytesRead < 0)
         {
            current->DebugPrint("%s-%d: Read error on Manta %d",
                  __FILE__, __LINE__, current->GetSerialNumber());
            throw(MantaCommunicationException(current));
         }
         else if(bytesRead)
         {
            current->FrameReceived(inFrame);
         }
      }
      ++i;
   }

   /* pop one item off the transmit queue and send down to its target */
   if(! txQueue.empty())
   {
      int bytesWritten;
      MantaTxQueueEntry *txMessage = txQueue.front();
      txQueue.pop_front();
      bytesWritten = hid_write(txMessage->TargetManta->DeviceHandle,
            txMessage->OutFrame, OutPacketLen + 1);
      txMessage->TargetManta->DebugPrint("%s-%d: Frame Written to Manta %d",
            __FILE__, __LINE__, txMessage->TargetManta->GetSerialNumber());
      for(int i = 0; i < 16; i += 8)
      {
         uint8_t *frame = txMessage->OutFrame + 1;
         txMessage->TargetManta->DebugPrint("\t\t%x %x %x %x %x %x %x %x",
               frame[i], frame[i+1], frame[i+2], frame[i+3], frame[i+4],
               frame[i+5], frame[i+6], frame[i+7]);
      }
      delete txMessage;
      if(bytesWritten < 0)
      {
         txMessage->TargetManta->DebugPrint("%s-%d: Write error on Manta %d",
               __FILE__, __LINE__, txMessage->TargetManta->GetSerialNumber());
         throw(MantaCommunicationException(txMessage->TargetManta));
      }
   }
}
\end{DoxyCode}
\hypertarget{classMantaUSB_a8464350b672b1c10f537bb2e3147e1c3}{\index{\-Manta\-U\-S\-B@{\-Manta\-U\-S\-B}!\-Is\-Connected@{\-Is\-Connected}}
\index{\-Is\-Connected@{\-Is\-Connected}!MantaUSB@{\-Manta\-U\-S\-B}}
\subsubsection[{\-Is\-Connected}]{\setlength{\rightskip}{0pt plus 5cm}bool {\bf \-Manta\-U\-S\-B\-::\-Is\-Connected} (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}}\label{classMantaUSB_a8464350b672b1c10f537bb2e3147e1c3}


\-Definition at line 87 of file \-Manta\-U\-S\-B.\-cpp.


\begin{DoxyCode}
{
   return DeviceHandle != NULL;
}
\end{DoxyCode}
\hypertarget{classMantaUSB_a3806f690096fa9a8885cd2d4733a898d}{\index{\-Manta\-U\-S\-B@{\-Manta\-U\-S\-B}!\-Message\-Queued@{\-Message\-Queued}}
\index{\-Message\-Queued@{\-Message\-Queued}!MantaUSB@{\-Manta\-U\-S\-B}}
\subsubsection[{\-Message\-Queued}]{\setlength{\rightskip}{0pt plus 5cm}bool {\bf \-Manta\-U\-S\-B\-::\-Message\-Queued} (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}}\label{classMantaUSB_a3806f690096fa9a8885cd2d4733a898d}


\-Definition at line 29 of file \-Manta\-U\-S\-B.\-cpp.


\begin{DoxyCode}
{
   return GetQueuedTxMessage() != NULL;
}
\end{DoxyCode}
\hypertarget{classMantaUSB_a38a9bc76333bab47574c63e1fe610002}{\index{\-Manta\-U\-S\-B@{\-Manta\-U\-S\-B}!\-Write\-Frame@{\-Write\-Frame}}
\index{\-Write\-Frame@{\-Write\-Frame}!MantaUSB@{\-Manta\-U\-S\-B}}
\subsubsection[{\-Write\-Frame}]{\setlength{\rightskip}{0pt plus 5cm}void {\bf \-Manta\-U\-S\-B\-::\-Write\-Frame} (
\begin{DoxyParamCaption}
\item[{uint8\-\_\-t $\ast$}]{frame, }
\item[{bool}]{force\-Queued}
\end{DoxyParamCaption}
)}}\label{classMantaUSB_a38a9bc76333bab47574c63e1fe610002}


\-Writs a \-U\-S\-B transfer frame down to the \hyperlink{classManta}{\-Manta}. 


\begin{DoxyParams}{\-Parameters}
{\em frame} & \-Pointer to the frame to be transmitted \\
\hline
{\em force\-Queued} & \-Forces this message to be queued instead of merged \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{\-Returns}
none
\end{DoxyReturn}
\hyperlink{classMantaUSB_a38a9bc76333bab47574c63e1fe610002}{\-Write\-Frame()} is meant to be called by the \hyperlink{classManta}{\-Manta} subclass, which defines methods for the individual messages (set\-L\-E\-D, etc). libmanta maintains a message queue that gets popped from in the \hyperlink{classMantaUSB_a4d55c1c1d9e769ce7a0ef532a72221e8}{\-Handle\-Events()} handler.

\-The default behavior is that if a message is already queued up for a given \hyperlink{classManta}{\-Manta}, subsequent message will be merged into the waiting message instead of being further queued (the queued frame will be the end result of all queued messages). force\-Queued can be set to true to force the message to be queued as a separate message instead of being merged

\-Note\-: \-Because \hyperlink{classMantaUSB_a38a9bc76333bab47574c63e1fe610002}{\-Write\-Frame()} accesses the same message queue that \hyperlink{classMantaUSB_a4d55c1c1d9e769ce7a0ef532a72221e8}{\-Handle\-Events()} does, they should be protected from each other by a mutex on the application level if they're being called from parallel threads. 

\-Definition at line 54 of file \-Manta\-U\-S\-B.\-cpp.


\begin{DoxyCode}
{
   int status;
   if(NULL == DeviceHandle)
   {
      throw(MantaNotConnectedException(this));
   }
   MantaTxQueueEntry *queuedMessage = GetQueuedTxMessage();
   if(queuedMessage && !forceQueued)
   {
      /* replace the queued packet payload with the new one */
      for(int i = 0; i < OutPacketLen; ++i)
      {
         /* the first byte of the report is the report ID (0x00) */
         queuedMessage->OutFrame[i+1] = frame[i];
      }
      DebugPrint("%s-%d: (WriteFrame) Queued Transfer overwritten on Manta %d",
            __FILE__, __LINE__, GetSerialNumber());
   }
   else
   {
      /* no transfer in progress, queue up a new one */
      MantaTxQueueEntry *newMessage = new MantaTxQueueEntry;
      newMessage->OutFrame[0] = 0;
      newMessage->TargetManta = this;
      /* the first byte of the report is the report ID (0x00) */
      memcpy(newMessage->OutFrame + 1, frame, OutPacketLen);
      txQueue.push_back(newMessage);
      DebugPrint("%s-%d: (WriteFrame) Transfer Queued on Manta %d",
            __FILE__, __LINE__, GetSerialNumber());
   }
}
\end{DoxyCode}


\subsection{\-Member \-Data \-Documentation}
\hypertarget{classMantaUSB_ab1b01bd783ce58a4cfceadaf593759e8}{\index{\-Manta\-U\-S\-B@{\-Manta\-U\-S\-B}!\-Device\-Handle@{\-Device\-Handle}}
\index{\-Device\-Handle@{\-Device\-Handle}!MantaUSB@{\-Manta\-U\-S\-B}}
\subsubsection[{\-Device\-Handle}]{\setlength{\rightskip}{0pt plus 5cm}{\bf hid\-\_\-device}$\ast$ {\bf \-Manta\-U\-S\-B\-::\-Device\-Handle}\hspace{0.3cm}{\ttfamily  \mbox{[}private\mbox{]}}}}\label{classMantaUSB_ab1b01bd783ce58a4cfceadaf593759e8}


\-Definition at line 66 of file \-Manta\-U\-S\-B.\-h.

\hypertarget{classMantaUSB_afe5ae885264a5aff980c5c645a3ff9d6}{\index{\-Manta\-U\-S\-B@{\-Manta\-U\-S\-B}!\-Endpoint\-In@{\-Endpoint\-In}}
\index{\-Endpoint\-In@{\-Endpoint\-In}!MantaUSB@{\-Manta\-U\-S\-B}}
\subsubsection[{\-Endpoint\-In}]{\setlength{\rightskip}{0pt plus 5cm}const int {\bf \-Manta\-U\-S\-B\-::\-Endpoint\-In} = 0x81\hspace{0.3cm}{\ttfamily  \mbox{[}static, private\mbox{]}}}}\label{classMantaUSB_afe5ae885264a5aff980c5c645a3ff9d6}


\-Definition at line 60 of file \-Manta\-U\-S\-B.\-h.

\hypertarget{classMantaUSB_ab3926f81d0c1b5993d583a34343e0b6d}{\index{\-Manta\-U\-S\-B@{\-Manta\-U\-S\-B}!\-Endpoint\-Out@{\-Endpoint\-Out}}
\index{\-Endpoint\-Out@{\-Endpoint\-Out}!MantaUSB@{\-Manta\-U\-S\-B}}
\subsubsection[{\-Endpoint\-Out}]{\setlength{\rightskip}{0pt plus 5cm}const int {\bf \-Manta\-U\-S\-B\-::\-Endpoint\-Out} = 0x02\hspace{0.3cm}{\ttfamily  \mbox{[}static, private\mbox{]}}}}\label{classMantaUSB_ab3926f81d0c1b5993d583a34343e0b6d}


\-Definition at line 61 of file \-Manta\-U\-S\-B.\-h.

\hypertarget{classMantaUSB_a13d2528c9c12d91dd34a8f99b3fed0b3}{\index{\-Manta\-U\-S\-B@{\-Manta\-U\-S\-B}!\-In\-Packet\-Len@{\-In\-Packet\-Len}}
\index{\-In\-Packet\-Len@{\-In\-Packet\-Len}!MantaUSB@{\-Manta\-U\-S\-B}}
\subsubsection[{\-In\-Packet\-Len}]{\setlength{\rightskip}{0pt plus 5cm}const int {\bf \-Manta\-U\-S\-B\-::\-In\-Packet\-Len} = 64\hspace{0.3cm}{\ttfamily  \mbox{[}static, protected\mbox{]}}}}\label{classMantaUSB_a13d2528c9c12d91dd34a8f99b3fed0b3}


\-Definition at line 46 of file \-Manta\-U\-S\-B.\-h.

\hypertarget{classMantaUSB_acde414c7e155d869f5c399518e32d38d}{\index{\-Manta\-U\-S\-B@{\-Manta\-U\-S\-B}!\-Interface@{\-Interface}}
\index{\-Interface@{\-Interface}!MantaUSB@{\-Manta\-U\-S\-B}}
\subsubsection[{\-Interface}]{\setlength{\rightskip}{0pt plus 5cm}const int {\bf \-Manta\-U\-S\-B\-::\-Interface} = 0\hspace{0.3cm}{\ttfamily  \mbox{[}static, private\mbox{]}}}}\label{classMantaUSB_acde414c7e155d869f5c399518e32d38d}


\-Definition at line 59 of file \-Manta\-U\-S\-B.\-h.

\hypertarget{classMantaUSB_a689a16560bfa8ecd1681e2f0397f68f2}{\index{\-Manta\-U\-S\-B@{\-Manta\-U\-S\-B}!\-Manta\-Index@{\-Manta\-Index}}
\index{\-Manta\-Index@{\-Manta\-Index}!MantaUSB@{\-Manta\-U\-S\-B}}
\subsubsection[{\-Manta\-Index}]{\setlength{\rightskip}{0pt plus 5cm}int {\bf \-Manta\-U\-S\-B\-::\-Manta\-Index}\hspace{0.3cm}{\ttfamily  \mbox{[}protected\mbox{]}}}}\label{classMantaUSB_a689a16560bfa8ecd1681e2f0397f68f2}


\-Definition at line 48 of file \-Manta\-U\-S\-B.\-h.

\hypertarget{classMantaUSB_a6c2c001a6d17abfd0f6ab6a6d36ce288}{\index{\-Manta\-U\-S\-B@{\-Manta\-U\-S\-B}!manta\-List@{manta\-List}}
\index{manta\-List@{manta\-List}!MantaUSB@{\-Manta\-U\-S\-B}}
\subsubsection[{manta\-List}]{\setlength{\rightskip}{0pt plus 5cm}list$<$ {\bf \-Manta\-U\-S\-B} $\ast$ $>$ {\bf \-Manta\-U\-S\-B\-::manta\-List}\hspace{0.3cm}{\ttfamily  \mbox{[}static, private\mbox{]}}}}\label{classMantaUSB_a6c2c001a6d17abfd0f6ab6a6d36ce288}


\-Definition at line 68 of file \-Manta\-U\-S\-B.\-h.

\hypertarget{classMantaUSB_a32fd2c8f871a3639bf913f599c2f3b04}{\index{\-Manta\-U\-S\-B@{\-Manta\-U\-S\-B}!\-Out\-Packet\-Len@{\-Out\-Packet\-Len}}
\index{\-Out\-Packet\-Len@{\-Out\-Packet\-Len}!MantaUSB@{\-Manta\-U\-S\-B}}
\subsubsection[{\-Out\-Packet\-Len}]{\setlength{\rightskip}{0pt plus 5cm}const int {\bf \-Manta\-U\-S\-B\-::\-Out\-Packet\-Len} = 16\hspace{0.3cm}{\ttfamily  \mbox{[}static, protected\mbox{]}}}}\label{classMantaUSB_a32fd2c8f871a3639bf913f599c2f3b04}


\-Definition at line 45 of file \-Manta\-U\-S\-B.\-h.

\hypertarget{classMantaUSB_aa78f9ab72991bc6ed711e6b823e98a00}{\index{\-Manta\-U\-S\-B@{\-Manta\-U\-S\-B}!\-Product\-I\-D@{\-Product\-I\-D}}
\index{\-Product\-I\-D@{\-Product\-I\-D}!MantaUSB@{\-Manta\-U\-S\-B}}
\subsubsection[{\-Product\-I\-D}]{\setlength{\rightskip}{0pt plus 5cm}const int {\bf \-Manta\-U\-S\-B\-::\-Product\-I\-D} = 0x2424\hspace{0.3cm}{\ttfamily  \mbox{[}static, private\mbox{]}}}}\label{classMantaUSB_aa78f9ab72991bc6ed711e6b823e98a00}


\-Definition at line 64 of file \-Manta\-U\-S\-B.\-h.

\hypertarget{classMantaUSB_a665d9f2432ded4c447e53dba384cbb69}{\index{\-Manta\-U\-S\-B@{\-Manta\-U\-S\-B}!\-Serial\-Number@{\-Serial\-Number}}
\index{\-Serial\-Number@{\-Serial\-Number}!MantaUSB@{\-Manta\-U\-S\-B}}
\subsubsection[{\-Serial\-Number}]{\setlength{\rightskip}{0pt plus 5cm}int {\bf \-Manta\-U\-S\-B\-::\-Serial\-Number}\hspace{0.3cm}{\ttfamily  \mbox{[}protected\mbox{]}}}}\label{classMantaUSB_a665d9f2432ded4c447e53dba384cbb69}


\-Definition at line 47 of file \-Manta\-U\-S\-B.\-h.

\hypertarget{classMantaUSB_aa2a88b5675ef513922f1bd4748d12181}{\index{\-Manta\-U\-S\-B@{\-Manta\-U\-S\-B}!\-Timeout@{\-Timeout}}
\index{\-Timeout@{\-Timeout}!MantaUSB@{\-Manta\-U\-S\-B}}
\subsubsection[{\-Timeout}]{\setlength{\rightskip}{0pt plus 5cm}const int {\bf \-Manta\-U\-S\-B\-::\-Timeout} = 5000\hspace{0.3cm}{\ttfamily  \mbox{[}static, private\mbox{]}}}}\label{classMantaUSB_aa2a88b5675ef513922f1bd4748d12181}


\-Definition at line 62 of file \-Manta\-U\-S\-B.\-h.

\hypertarget{classMantaUSB_ab647636b02371d10ccedaf719b6b7de2}{\index{\-Manta\-U\-S\-B@{\-Manta\-U\-S\-B}!tx\-Queue@{tx\-Queue}}
\index{tx\-Queue@{tx\-Queue}!MantaUSB@{\-Manta\-U\-S\-B}}
\subsubsection[{tx\-Queue}]{\setlength{\rightskip}{0pt plus 5cm}list$<$ {\bf \-Manta\-U\-S\-B\-::\-Manta\-Tx\-Queue\-Entry} $\ast$ $>$ {\bf \-Manta\-U\-S\-B\-::tx\-Queue}\hspace{0.3cm}{\ttfamily  \mbox{[}static, private\mbox{]}}}}\label{classMantaUSB_ab647636b02371d10ccedaf719b6b7de2}


\-Definition at line 69 of file \-Manta\-U\-S\-B.\-h.

\hypertarget{classMantaUSB_ad3b9f90c7681710d99dd984000a7859e}{\index{\-Manta\-U\-S\-B@{\-Manta\-U\-S\-B}!\-Vendor\-I\-D@{\-Vendor\-I\-D}}
\index{\-Vendor\-I\-D@{\-Vendor\-I\-D}!MantaUSB@{\-Manta\-U\-S\-B}}
\subsubsection[{\-Vendor\-I\-D}]{\setlength{\rightskip}{0pt plus 5cm}const int {\bf \-Manta\-U\-S\-B\-::\-Vendor\-I\-D} = 0x2424\hspace{0.3cm}{\ttfamily  \mbox{[}static, private\mbox{]}}}}\label{classMantaUSB_ad3b9f90c7681710d99dd984000a7859e}


\-Definition at line 63 of file \-Manta\-U\-S\-B.\-h.



\-The documentation for this class was generated from the following files\-:\begin{DoxyCompactItemize}
\item 
\hyperlink{MantaUSB_8h}{\-Manta\-U\-S\-B.\-h}\item 
\hyperlink{MantaUSB_8cpp}{\-Manta\-U\-S\-B.\-cpp}\end{DoxyCompactItemize}
